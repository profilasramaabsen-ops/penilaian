<!DOCTYPE html>
<html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Login</title>

  <style>
    
  </style>

  
</head>
<body>
  <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Penilaian - PPB Asy-Syifa'iyyah</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c5c1f;
            --secondary-color: #4a8c31;
            --accent-color: #e9f5e3;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
        
        .app-container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .sidebar {
            background-color: var(--accent-color);
            padding: 15px;
            border-radius: 8px;
            height: fit-content;
        }
        
        .main-content {
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .card {
            margin-bottom: 15px;
            border: none;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .card-header {
            background-color: var(--accent-color);
            font-weight: bold;
        }
        
        .group-selector {
            cursor: pointer;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .group-selector:hover, .group-selector.active {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .criteria-badge {
            font-size: 0.8rem;
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .table th {
            background-color: var(--accent-color);
        }
        
        .hidden {
            display: none;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .logo img {
            max-width: 120px;
        }
        
        .evaluation-card {
            transition: all 0.3s;
        }
        
        .evaluation-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div id="loginPage" class="login-container">
        <div class="logo">
            <i class="fas fa-mosque fa-3x" style="color: var(--primary-color);"></i>
            <h3 class="mt-2">Pondok Pesantren<br>Bidayatul Hidayah</h3>
            <p class="text-muted">Asrama Asy-Syifa'iyyah</p>
        </div>
        
        <div id="groupSelection" class="mb-3 card p-3">
            <h6 class="text-center">Pilih Kelompok/Mustahiq</h6>
            <div class="d-flex flex-wrap justify-content-center" id="groupList">
                <!-- Groups will be populated by JavaScript -->
            </div>
        </div>
        
        <form id="loginForm">
            <div class="mb-3">
                <label for="username" class="form-label">Username</label>
                <input type="text" class="form-control" id="username" required>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" class="form-control" id="password" required>
            </div>
            <button type="submit" class="btn btn-primary w-100">Masuk</button>
        </form>
    </div>

    <!-- Main Application -->
    <div id="appPage" class="app-container">
        <div class="header d-flex justify-content-between align-items-center">
            <div>
                <h2><i class="fas fa-mosque"></i> Pondok Pesantren Bidayatul Hidayah</h2>
                <p class="mb-0">Asrama Asy-Syifa'iyyah - Sistem Penilaian Santri</p>
            </div>
            <div>
                <span id="currentUser" class="me-3"></span>
                <button id="logoutBtn" class="btn btn-light"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </div>
        
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3">
                <div class="sidebar">
                    <h5 class="text-center">Daftar Kelompok</h5>
                    <div id="sidebarGroups">
                        <!-- Groups will be populated by JavaScript -->
                    </div>
                    
                    <div id="adminControls" class="mt-3 hidden">
                        <hr>
                        <h6 class="text-center">Kontrol Admin</h6>
                        <button id="addGroupBtn" class="btn btn-sm btn-primary w-100 mb-2">Tambah Kelompok</button>
                        <button id="manageStudentsBtn" class="btn btn-sm btn-primary w-100">Kelola Santri</button>
                    </div>
                </div>
                
                <div class="mt-3 text-center">
                    <button id="downloadBtn" class="btn btn-success w-100"><i class="fas fa-download"></i> Download Nilai</button>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9">
                <div class="main-content">
                    <h4 id="currentGroupTitle" class="text-center mb-4">Pilih Kelompok untuk Melihat Data</h4>
                    
                    <div id="adminView">
                        <!-- Admin view content will be populated by JavaScript -->
                    </div>
                    
                    <div id="teacherView">
                        <!-- Teacher view content will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal fade" id="addGroupModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tambah Kelompok Baru</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addGroupForm">
                        <div class="mb-3">
                            <label for="newGroupName" class="form-label">Nama Kelompok/Mustahiq</label>
                            <input type="text" class="form-control" id="newGroupName" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="saveGroupBtn">Simpan</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="manageStudentsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Kelola Data Santri</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-between mb-3">
                        <h6>Daftar Santri: <span id="currentGroupName"></span></h6>
                        <button class="btn btn-sm btn-primary" id="addStudentBtn">Tambah Santri</button>
                    </div>
                    <div id="studentsList">
                        <!-- Students will be populated by JavaScript -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Data storage (in a real application, this would be replaced with API calls)
        let groups = [
            { id: 1, name: "Mustahiq Ust. Ahmad" },
            { id: 2, name: "Mustahiq Ust. Fadhil" },
            { id: 3, name: "Mustahiq Ust. Hasan" }
        ];
        
        let students = [
            { id: 1, name: "Abdullah", groupId: 1 },
            { id: 2, name: "Fathurrahman", groupId: 1 },
            { id: 3, name: "Muhammad", groupId: 2 },
            { id: 4, name: "Ali", groupId: 3 }
        ];
        
        let evaluations = [];
        
        // User accounts
        const users = [
            { username: "ppbhasyadmin", password: "asyadmin", role: "admin", groupId: null },
            { username: "ppbhasy1", password: "asy123", role: "teacher", groupId: null },
            { username: "ppbhasy2", password: "asy123", role: "teacher", groupId: null },
            { username: "ppbhasy3", password: "asy123", role: "teacher", groupId: null },
            { username: "ppbhasy4", password: "asy123", role: "teacher", groupId: null },
            { username: "ppbhasy5", password: "asy123", role: "teacher", groupId: null }
        ];
        
        // Current user state
        let currentUser = null;
        let selectedGroupId = null;
        
        // DOM elements
        const loginPage = document.getElementById('loginPage');
        const appPage = document.getElementById('appPage');
        const loginForm = document.getElementById('loginForm');
        const groupSelection = document.getElementById('groupSelection');
        const groupList = document.getElementById('groupList');
        const sidebarGroups = document.getElementById('sidebarGroups');
        const currentUserSpan = document.getElementById('currentUser');
        const logoutBtn = document.getElementById('logoutBtn');
        const adminControls = document.getElementById('adminControls');
        const adminView = document.getElementById('adminView');
        const teacherView = document.getElementById('teacherView');
        const currentGroupTitle = document.getElementById('currentGroupTitle');
        const addGroupBtn = document.getElementById('addGroupBtn');
        const manageStudentsBtn = document.getElementById('manageStudentsBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        
        // Initialize the application
        function init() {
            renderGroupSelection();
            bindEvents();
        }
        
        // Render group selection in login page
        function renderGroupSelection() {
            groupList.innerHTML = '';
            groups.forEach(group => {
                const groupElement = document.createElement('div');
                groupElement.className = 'group-selector';
                groupElement.textContent = group.name;
                groupElement.dataset.id = group.id;
                groupList.appendChild(groupElement);
            });
        }
        
        // Render groups in sidebar
        function renderSidebarGroups() {
            sidebarGroups.innerHTML = '';
            groups.forEach(group => {
                const groupElement = document.createElement('div');
                groupElement.className = 'group-selector';
                groupElement.textContent = group.name;
                groupElement.dataset.id = group.id;
                sidebarGroups.appendChild(groupElement);
            });
        }
        
        // Bind event listeners
        function bindEvents() {
            // Login form submission
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // Find user
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    currentUser = user;
                    
                    // For non-admin users, check if a group is selected
                    if (user.role !== 'admin' && !selectedGroupId) {
                        alert('Silakan pilih kelompok terlebih dahulu');
                        return;
                    }
                    
                    // For non-admin users, set their groupId
                    if (user.role !== 'admin' && selectedGroupId) {
                        user.groupId = selectedGroupId;
                    }
                    
                    loginPage.style.display = 'none';
                    appPage.style.display = 'block';
                    currentUserSpan.textContent = `Login sebagai: ${user.username}`;
                    
                    // Show admin controls for admin user
                    if (user.role === 'admin') {
                        adminControls.classList.remove('hidden');
                        renderAdminView();
                    } else {
                        adminControls.classList.add('hidden');
                        renderTeacherView();
                    }
                } else {
                    alert('Username atau password salah');
                }
            });
            
            // Group selection in login page
            groupList.addEventListener('click', function(e) {
                if (e.target.classList.contains('group-selector')) {
                    // Remove active class from all groups
                    document.querySelectorAll('.group-selector').forEach(el => {
                        el.classList.remove('active');
                    });
                    
                    // Add active class to selected group
                    e.target.classList.add('active');
                    selectedGroupId = parseInt(e.target.dataset.id);
                }
            });
            
            // Group selection in sidebar
            sidebarGroups.addEventListener('click', function(e) {
                if (e.target.classList.contains('group-selector')) {
                    // Remove active class from all groups
                    document.querySelectorAll('.group-selector').forEach(el => {
                        el.classList.remove('active');
                    });
                    
                    // Add active class to selected group
                    e.target.classList.add('active');
                    selectedGroupId = parseInt(e.target.dataset.id);
                    
                    // Refresh view based on user role
                    if (currentUser.role === 'admin') {
                        renderAdminView();
                    } else {
                        renderTeacherView();
                    }
                }
            });
            
            // Logout button
            logoutBtn.addEventListener('click', function() {
                currentUser = null;
                selectedGroupId = null;
                loginPage.style.display = 'block';
                appPage.style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // Remove active class from all groups
                document.querySelectorAll('.group-selector').forEach(el => {
                    el.classList.remove('active');
                });
            });
            
            // Add group button (admin only)
            addGroupBtn.addEventListener('click', function() {
                const modal = new bootstrap.Modal(document.getElementById('addGroupModal'));
                modal.show();
            });
            
            // Save group button
            document.getElementById('saveGroupBtn').addEventListener('click', function() {
                const newGroupName = document.getElementById('newGroupName').value;
                if (newGroupName) {
                    const newGroup = {
                        id: groups.length > 0 ? Math.max(...groups.map(g => g.id)) + 1 : 1,
                        name: newGroupName
                    };
                    
                    groups.push(newGroup);
                    renderSidebarGroups();
                    renderGroupSelection();
                    
                    const modal = bootstrap.Modal.getInstance(document.getElementById('addGroupModal'));
                    modal.hide();
                    
                    document.getElementById('newGroupName').value = '';
                }
            });
            
            // Manage students button
            manageStudentsBtn.addEventListener('click', function() {
                renderStudentsList();
                const modal = new bootstrap.Modal(document.getElementById('manageStudentsModal'));
                modal.show();
            });
            
            // Download button
            downloadBtn.addEventListener('click', function() {
                // In a real application, this would generate a file for download
                alert('Fitur download akan mengunduh semua data nilai dalam format Excel');
            });
        }
        
        // Render admin view
        function renderAdminView() {
            adminView.classList.remove('hidden');
            teacherView.classList.add('hidden');
            
            if (selectedGroupId) {
                const group = groups.find(g => g.id === selectedGroupId);
                currentGroupTitle.textContent = `Data Nilai: ${group.name}`;
                
                // Get students in this group
                const groupStudents = students.filter(s => s.groupId === selectedGroupId);
                
                let html = `
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Nama Santri</th>
                                    <th>Kelancaran</th>
                                    <th>Tajwid</th>
                                    <th>Fashohah</th>
                                    <th>Tasmi' 1-5</th>
                                    <th>Tasmi' 6-10</th>
                                    <th>Tasmi' 1-10</th>
                                    <th>Tasmi' 11-15</th>
                                    <th>Tasmi' 16-20</th>
                                    <th>Tasmi' 11-20</th>
                                    <th>Tasmi' 21-25</th>
                                    <th>Tasmi' 26-30</th>
                                    <th>Tasmi' 21-30</th>
                                    <th>Perilaku</th>
                                    <th>Akhlaq</th>
                                    <th>Ketertiban</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                groupStudents.forEach(student => {
                    const studentEvals = evaluations.filter(e => e.studentId === student.id);
                    
                    html += `
                        <tr>
                            <td>${student.name}</td>
                            <td>${getEvaluationValue(studentEvals, 'kelancaran')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tajwid')}</td>
                            <td>${getEvaluationValue(studentEvals, 'fashohah')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi1-5')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi6-10')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi1-10')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi11-15')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi16-20')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi11-20')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi21-25')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi26-30')}</td>
                            <td>${getEvaluationValue(studentEvals, 'tasmi21-30')}</td>
                            <td>${getEvaluationValue(studentEvals, 'perilaku')}</td>
                            <td>${getEvaluationValue(studentEvals, 'akhlaq')}</td>
                            <td>${getEvaluationValue(studentEvals, 'ketertiban')}</td>
                            <td>
                                <button class="btn btn-sm btn-primary edit-student" data-id="${student.id}">Edit</button>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                adminView.innerHTML = html;
            } else {
                currentGroupTitle.textContent = "Pilih Kelompok untuk Melihat Data";
                adminView.innerHTML = '<p class="text-center">Silakan pilih kelompok dari menu sebelah kiri</p>';
            }
        }
        
        // Helper function to get evaluation value
        function getEvaluationValue(evaluations, type) {
            const eval = evaluations.find(e => e.type === type);
            return eval ? eval.value : '-';
        }
        
        // Render teacher view
        function renderTeacherView() {
            adminView.classList.add('hidden');
            teacherView.classList.remove('hidden');
            
            if (selectedGroupId) {
                const group = groups.find(g => g.id === selectedGroupId);
                currentGroupTitle.textContent = `Input Nilai: ${group.name}`;
                
                // Get students in this group
                const groupStudents = students.filter(s => s.groupId === selectedGroupId);
                
                let html = '';
                
                // Different forms based on teacher type
                if (currentUser.username === 'ppbhasy1') {
                    html = `
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card evaluation-card">
                                    <div class="card-header">Input Nilai Kelancaran, Tajwid, dan Fashohah</div>
                                    <div class="card-body">
                                        <form id="evaluationForm1">
                                            <div class="mb-3">
                                                <label class="form-label">Pilih Santri</label>
                                                <select class="form-select" id="studentSelect">
                                                    ${groupStudents.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
                                                </select>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Nilai Kelancaran</label>
                                                        <input type="number" class="form-control" id="kelancaranInput" min="0" max="100" required>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Nilai Tajwid</label>
                                                        <input type="number" class="form-control" id="tajwidInput" min="0" max="100" required>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Nilai Fashohah</label>
                                                        <input type="number" class="form-control" id="fashohahInput" min="0" max="100" required>
                                                    </div>
                                                </div>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Kirim Nilai</button>
                                            <button type="button" class="btn btn-secondary hidden" id="cancelBtn">Batal Kirim</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (currentUser.username === 'ppbhasy2') {
                    // Similar form for ppbhasy2 with different fields
                    html = `
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card evaluation-card">
                                    <div class="card-header">Input Nilai Tasmi' 1-5, 6-10, dan 1-10</div>
                                    <div class="card-body">
                                        <form id="evaluationForm2">
                                            <div class="mb-3">
                                                <label class="form-label">Pilih Santri</label>
                                                <select class="form-select" id="studentSelect">
                                                    ${groupStudents.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
                                                </select>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Tasmi' 1-5</label>
                                                        <input type="number" class="form-control" id="tasmi1-5Input" min="0" max="100" required>
                                                        <textarea class="form-control mt-2" placeholder="Catatan" rows="2"></textarea>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Tasmi' 6-10</label>
                                                        <input type="number" class="form-control" id="tasmi6-10Input" min="0" max="100" required>
                                                        <textarea class="form-control mt-2" placeholder="Catatan" rows="2"></textarea>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Tasmi' 1-10</label>
                                                        <input type="number" class="form-control" id="tasmi1-10Input" min="0" max="100" required>
                                                        <textarea class="form-control mt-2" placeholder="Catatan" rows="2"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Kirim Nilai</button>
                                            <button type="button" class="btn btn-secondary hidden" id="cancelBtn">Batal Kirim</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (currentUser.username === 'ppbhasy5') {
                    // Form for behavioral evaluation
                    html = `
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card evaluation-card">
                                    <div class="card-header">Input Nilai Perilaku, Akhlaq, dan Ketertiban</div>
                                    <div class="card-body">
                                        <form id="evaluationForm5">
                                            <div class="mb-3">
                                                <label class="form-label">Pilih Santri</label>
                                                <select class="form-select" id="studentSelect">
                                                    ${groupStudents.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
                                                </select>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Perilaku</label>
                                                        <select class="form-select" id="perilakuSelect" required>
                                                            <option value="">Pilih Nilai</option>
                                                            <option value="A">A</option>
                                                            <option value="B">B</option>
                                                            <option value="C">C</option>
                                                            <option value="D">D</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Akhlaq</label>
                                                        <select class="form-select" id="akhlaqSelect" required>
                                                            <option value="">Pilih Nilai</option>
                                                            <option value="A">A</option>
                                                            <option value="B">B</option>
                                                            <option value="C">C</option>
                                                            <option value="D">D</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="mb-3">
                                                        <label class="form-label">Ketertiban</label>
                                                        <select class="form-select" id="ketertibanSelect" required>
                                                            <option value="">Pilih Nilai</option>
                                                            <option value="A">A</option>
                                                            <option value="B">B</option>
                                                            <option value="C">C</option>
                                                            <option value="D">D</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Catatan</label>
                                                <textarea class="form-control" id="catatanInput" rows="3"></textarea>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Kirim Nilai</button>
                                            <button type="button" class="btn btn-secondary hidden" id="cancelBtn">Batal Kirim</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Forms for other teachers would go here
                    html = `<p class="text-center">Form input nilai untuk ${currentUser.username}</p>`;
                }
                
                teacherView.innerHTML = html;
                
                // Add event listener for form submission
                const formId = `evaluationForm${currentUser.username.slice(-1)}`;
                const form = document.getElementById(formId);
                if (form) {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        // In a real application, this would save the evaluation
                        alert('Nilai berhasil dikirim!');
                        
                        // Hide submit button and show cancel button
                        const submitBtn = form.querySelector('button[type="submit"]');
                        const cancelBtn = document.getElementById('cancelBtn');
                        submitBtn.classList.add('hidden');
                        cancelBtn.classList.remove('hidden');
                    });
                }
                
                // Add event listener for cancel button
                const cancelBtn = document.getElementById('cancelBtn');
                if (cancelBtn) {
                    cancelBtn.addEventListener('click', function() {
                        const form = document.getElementById(formId);
                        if (form) form.reset();
                        
                        // Show submit button and hide cancel button
                        const submitBtn = form.querySelector('button[type="submit"]');
                        submitBtn.classList.remove('hidden');
                        cancelBtn.classList.add('hidden');
                    });
                }
            } else {
                currentGroupTitle.textContent = "Pilih Kelompok untuk Input Nilai";
                teacherView.innerHTML = '<p class="text-center">Silakan pilih kelompok dari menu sebelah kiri</p>';
            }
        }
        
        // Render students list in management modal
        function renderStudentsList() {
            const studentsList = document.getElementById('studentsList');
            const currentGroupName = document.getElementById('currentGroupName');
            
            if (selectedGroupId) {
                const group = groups.find(g => g.id === selectedGroupId);
                currentGroupName.textContent = group.name;
                
                const groupStudents = students.filter(s => s.groupId === selectedGroupId);
                
                let html = `
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Nama Santri</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                groupStudents.forEach(student => {
                    html += `
                        <tr>
                            <td>${student.name}</td>
                            <td>
                                <button class="btn btn-sm btn-danger delete-student" data-id="${student.id}">Hapus</button>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                        </tbody>
                    </table>
                `;
                
                studentsList.innerHTML = html;
                
                // Add event listeners for delete buttons
                document.querySelectorAll('.delete-student').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const studentId = parseInt(this.dataset.id);
                        if (confirm('Apakah Anda yakin ingin menghapus santri ini?')) {
                            students = students.filter(s => s.id !== studentId);
                            renderStudentsList();
                        }
                    });
                });
            } else {
                studentsList.innerHTML = '<p class="text-center">Silakan pilih kelompok terlebih dahulu</p>';
            }
        }
        
        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

  <script>
    
  </script>
</body>
</html>
